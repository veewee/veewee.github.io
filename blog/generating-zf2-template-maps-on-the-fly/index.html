<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Generating ZF2 template maps on the fly</title><meta name=viewport content="width=device-width, initial-scale=1.0"><link rel=stylesheet href=/css/a862.blog.css><!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]--><link rel=apple-touch-icon-precomposed sizes=144x144 href=/images/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.ico><link rel=alternate type=application/atom+xml title="Toon Verwerft" href=https://veewee.github.io/atom.xml></head><body class=bs-docs-home><a class=sr-only href=#content>Skip to main content</a><header class="navbar navbar-inverse navbar-fixed-top bs-docs-nav" role=banner><div class=container><div class=navbar-header><button class=navbar-toggle type=button data-toggle=collapse data-target=.bs-navbar-collapse><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="/" class=navbar-brand>Toon Verwerft</a></div><nav class="collapse navbar-collapse bs-navbar-collapse" role=navigation><ul class="nav navbar-nav"><li><a href="/">Home</a></li><li><a href=https://twitter.com/toonverwerft>Twitter</a></li><li><a href="https://github.com/veewee/">Github</a></li><li><a href=https://www.linkedin.com/in/toonverwerft>LinkedIn</a></li><li><a href=https://speakerdeck.com/veewee>Talks</a></li></ul></nav></div></header><a name=#content></a><div id=content><div class=container><div class=row><div class="col-xs-12 col-sm-8 col-md-9 left-pane"><div class=post-details><h1>Generating ZF2 template maps on the fly</h1><div class=pull-right><span class="meta label label-info">19 Aug 2014</span></div><small>Tags: <a href=/tags/grunt class="label label-primary tag" title="View posts tagged with &quot;grunt&quot;">grunt</a> <a href=/tags/zf2 class="label label-primary tag" title="View posts tagged with &quot;zf2&quot;">zf2</a></small><div class=post><img src=/images/blog/20140819/8015.auto-template-mapping.jpg class=post-banner alt=""><p>One of the performance boosters in <a href="http://framework.zend.com/" target=_blank>Zend Framework 2</a> is using `template_map` instead of the `template_path_stack` in the view manager. While developing, it is easier to use the stack. This is because you don't have to add a mapping every time you create a new view. At the end of the development you might forget to transform the stack into a template map. This is why it is useful to <strong>never</strong> use the stack and automate the generation of the template_map array instead.</p><p>There is already a great tool called `<a href=https://github.com/zendframework/zf2/blob/master/bin/templatemap_generator.php target=_blank>templatemap_generator.php</a>` included in the bin folder of zf2. It can be used to generate a template map for every module in your application. In the next step, we want to make sure that this tool is called every time a view file is created. This kind of automation can be done with a task manager like `<a href="http://gruntjs.com/" target=_blank>Grunt</a>`.</p><h2>Sample configuration</h2><div class=highlight><pre><code class=js><span class=nx>grunt</span><span class=p>.</span><span class=nx>initConfig</span><span class=p>({</span>

    <span class=nx>phplint</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>applicationViews</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;module/Application/**/*.phtml&#39;</span><span class=p>],</span>
    <span class=p>}</span>

    <span class=nx>watch</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>applicationViews</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>files</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;module/Application/view/**/*.phtml&#39;</span><span class=p>],</span>
        <span class=nx>tasks</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;phplint:applicationViews&#39;</span><span class=p>,</span> <span class=s1>&#39;exec:generate_application_template_map&#39;</span><span class=p>]</span>
      <span class=p>}</span>
    <span class=p>},</span>

    <span class=nx>exec</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>generate_application_template_map</span><span class=o>:</span> <span class=p>{</span>
        <span class=nx>cmd</span><span class=o>:</span> <span class=s1>&#39;../../vendor/bin/templatemap_generator.php&#39;</span><span class=p>,</span>
        <span class=nx>cwd</span><span class=o>:</span> <span class=s1>&#39;module/Application&#39;</span>
      <span class=p>}</span>
    <span class=p>}</span>

<span class=p>});</span>

<span class=nx>grunt</span><span class=p>.</span><span class=nx>registerTask</span><span class=p>(</span><span class=s1>&#39;generate-template-maps&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;exec:template_map_application&#39;</span><span class=p>]);</span>
</code></pre></div><p>By using this configuration, Grunt will watch for file changes in the `view` folder of the `Application` module. When a file has changed, PHPLint will check for syntax errors and finally a new template map file will be generated. There is also a command named `generate-template-maps` which you can run manually.</p><p><em><strong>Note:</strong> Make sure to include the npm packages <a href=https://www.npmjs.org/package/grunt-exec target=_blank>grunt-exec</a> and <a href=https://npmjs.org/package/grunt-phplint target=_blank>grunt-phplint</a>.</em></p><h2>Conclusion</h2><p>By automating all of the boring tasks, you can gain a lot of time during development. If you want to automate some more tasks during PHP development, you can check an earlier blog called `<a href="http://veewee.github.io/blog/validating-your-php-code-on-the-fly/">Validating your PHP code on the fly</a>`.</p></div><div class="social clearfix"><div class=addthis_inline_share_toolbox></div><div id=atstbx_flattr class="at-share-tbx-element addthis-smartlayers addthis-animated at4-show"><div class=at-share-btn-elements><a role=button class="at-icon-wrapper at-share-btn flattr" href="https://flattr.com/submit/auto?fid=vo26re&url=http%3A%2F%2Fveewee.github.io%2Fblog%2Fgenerating-zf2-template-maps-on-the-fly" target=_blank><span class=at4-visually-hidden>Flattr this</span><span class=at-icon-wrapper style=""><svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink version=1.1 id=Capa_1 x=0px y=0px width=22px height=22px viewbox="0 0 533.333 533.333" style="enable-background:new 0 0 533.333 533.333" xml:space=preserve><g><path d="M191.438,0C64.689,0,0,73.001,0,209.3l0,0v95.211v190.745L124.161,370.97V225.711c0-56.466,14.964-92.399,65.166-100.466   l0,0c17.538-3.429,54.037-2.228,77.243-2.228l0,0v86.248c0,0.786,0.107,2.191,0.31,2.909l0,0c0.974,3.492,4.13,6.05,7.872,6.058   l0,0c2.116,0.004,4.098-1.096,6.143-3.109l0,0L496.06,0.033L351.627,0H191.438z M409.171,162.368v145.255   c0,56.466-14.967,92.403-65.164,100.466l0,0c-17.537,3.429-54.04,2.229-77.246,2.229l0,0V324.07c0-0.781-0.107-2.191-0.31-2.907   l0,0c-0.971-3.496-4.126-6.055-7.871-6.058l0,0c-2.117-0.004-4.097,1.1-6.141,3.107l0,0L37.271,533.299l144.431,0.034h160.191   c126.747,0,191.44-73.004,191.44-209.298l0,0V228.82V38.083L409.171,162.368z" fill=#FFFFFF></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></span><span class=at-label>Flattr</span></a></div></div></div><a name=comments></a><div id=disqus_thread></div><script type=text/javascript>var disqus_identifier = '/blog/generating-zf2-template-maps-on-the-fly';
        var disqus_title = 'Generating ZF2 template maps on the fly';
        var disqus_url = 'http://veewee.github.io/blog/generating-zf2-template-maps-on-the-fly';

        // trigger disqus-comments.js
        var embed_disqus_comments = true;</script></div></div><div class="col-xs-12 col-sm-4 col-md-3 right-pane"><h1>whois <small>VeeWee</small></h1><div><img src=/images/750d.picture.png class="img-thumbnail img-responsive selfie" alt=Selfie></div><div><h2>Hi there!</h2><p>Glad you made it to my blog. Please feel free to take a look around. You will find some interesting stuff, mostly about web development and PHP.</p><p>Still can't get enough of me? Quick! Take a look at my <a href=https://speakerdeck.com/veewee>Speakerdeck</a>, <a href=https://twitter.com/toonverwerft>Twitter</a> or <a href="https://github.com/veewee/">Github</a> account.</p></div><div class=list-group><a class=list-group-item href=//github.com/veewee/veewee.github.io/issues/new><span class="glyphicon glyphicon-pencil"></span> Contact Me</a> <a class=list-group-item href=/atom.xml><span class="glyphicon glyphicon-pushpin"></span> Subscribe to RSS</a></div></div></div></div></div><script src=/js/b1a7.vendor.js></script><script src=/js/e51f.blog.js></script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-57d8dc41723aa026"></script></body></html>